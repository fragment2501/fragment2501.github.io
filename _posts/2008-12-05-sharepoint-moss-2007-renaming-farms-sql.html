---
title: SharePoint MOSS 2007 - Renaming the farm's SQL Database Server
date: '2008-12-05T14:46:00.000-08:00'
tags:
- MOSS
- SharePoint
modified_time: '2008-12-05T17:42:53.935-08:00'
blogger_id: tag:blogger.com,1999:blog-19111454.post-8125939946347680719
blogger_orig_url: http://www.bryansgeekspeak.com/2008/12/sharepoint-moss-2007-renaming-farms-sql.html
---

A follow up post on the <a href="http://bryansgeekspeak.blogspot.com/2008/11/sharepoint-moss-2007-moving-farms-sql.html">SharePoint MOSS 2007 - Moving the farm's SQL databases</a> post, I'm now in the process of renaming the new SQL Server and updating my sharepoint farms to match.  I wanted to see if I could do something quick-n-dirty on my small sharepoint farm (1 SQL server and 1 WFE/Central Admin server) like this:<br /><br />1) shutdown sharepoint services and IIS on the sharepoint farm WFE/Central Admin server<br />2) rename the SQL Server and reboot<br />3) Run the renameserver command on the WFE/Central Admin server to point to the new SQL server name<br />4) start sharepoint services and IIS and hit the central admin<br /><br /><br /><span style="font-weight:bold;">SharePoint Farm #1</span><br />...and I pretty much got the same result as I described in my original post, without going through all the other steps of backing up the SSP or the databases (since we didnt move the databases to a new server).  Though my sites are working, my SSP's are broken.  When I got in to manage user profiles, I get a SQL server database error:<br /><br /><div class="code">An error has occurred while accessing the SQL Server database or the Office SharePoint Server Search service. If this is the first time you have seen this message, try again later. If this problem persists, contact your administrator.</div><br /><br />and the search admin page for the SSP crashes with a default sharepoint error. I havent found a way to change the SSP database in the central admin yet, I'll post here if I find another solution.  Otherwise, doing a backup and restore of the SSP is probably the only way to go.<br /><br />I was able to go back afterward to recreate the default SSP service by doing the following:<br /><br />1) from the central admin server, run "stsadm -o deletessp â€“title <SSP name> -force"<br />2) delete the old search database from the SQL server<br />3) recreate the SSP via the central administrator, mapping the SSP admin site and the mysites admin to the old web applications (I didnt delete those from the sharepoint farm).<br /><br />I was still getting the above error in the profile admin until I did an iisreset, then everything work like magic.  Time to test all this out on the next sharepoint farm (I've got 2 more farms to go!)<br /><br /><span style="font-weight:bold;">SharePoint Farm #2</span><br />... I think I just goofed up in my first farm update.  After the rename command, I brought up IIS first, then the sharepoint services.  I think that caused the SSP admin to choke until IIS was restarted...so I didnt need to delete and recreate my SSP after all -.-  On my second farm attempt, I followed the same steps as the first except for bringing up IIS after the sharepoint services had started, and everything seems to have come back up perfectly.<br /><br />This last sharepoint farm is used more than the other two and it has content deployment jobs as well, so it'll be a much better test...<br /><br /><span style="font-weight:bold;">SharePoint Farm #3</span><br />I think I've got it figured out now.  Just starting the services before starting IIS did -not- fix the problem with the SSP services failing when I went through this process on the third and final farm.  What fixed my problem this time around was going to the central admin, editing the shared service provider (Shared Services Administration -> edit properties of the shared service providers listed)...on the SSP edit screen, it shows the correct database settings. I just saved changes (even though I didnt change anything) and then restared sharepoint services and restarted IIS.  That seemed to do the trick, everything came up including the user profiles I had imported from Active Directory.  So the final process should go something like this:<br /><br />1) shutdown sharepoint services and IIS on the sharepoint farm WFE/Central Admin server<br />2) rename the SQL Server and reboot<br />3) Run the renameserver command on the WFE/Central Admin server to point to the new SQL server name<br />4) start sharepoint services and IIS and hit the central admin<br />5) edit each of your SSP's and re-save settings for each<br />6) restart sharepoint services and restart IIS