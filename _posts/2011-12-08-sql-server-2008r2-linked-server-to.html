---
title: SQL Server 2008R2 Linked Server to Oracle 11.2.0.2 Instance
date: '2011-12-08T13:05:00.001-08:00'
tags:
- Oracle
- SQL Server
modified_time: '2011-12-08T13:59:50.056-08:00'
thumbnail: http://4.bp.blogspot.com/-aJRmzsk6Wcw/TuEsmb4z0cI/AAAAAAAAAB4/CmOPzqDbR50/s72-c/Oracle11ClientInstallOptions.PNG
blogger_id: tag:blogger.com,1999:blog-19111454.post-2895952437861756884
blogger_orig_url: http://www.bryansgeekspeak.com/2011/12/sql-server-2008r2-linked-server-to.html
---

<p>My notes on doing this particular setup using SQL Server 2008R2 and Oracle 11.2.0.2 (64bit versions) on Windows Server 2008R2 64bit Enterprise edition.</p> <b>Install Oracle 11.2.02 64 bit client</b><p>Install the oracle client on the SQL Server machine where you want to add the linked server.  Install the following components only using the custom installation option.</p><ul><li>Oracle Database Utilities</li><li>SQL*Plus</li><li>Oracle Net</li><li>Oracle Provider for OLE DB</li><li>Oracle Data Provider for .NET (I dont think this is needed, but I always install it out of habit!)</li></ul> <div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-aJRmzsk6Wcw/TuEsmb4z0cI/AAAAAAAAAB4/CmOPzqDbR50/s1600/Oracle11ClientInstallOptions.PNG" imageanchor="1" style="clear:left; margin-right:1em; margin-bottom:1em"><img border="0" height="285" width="320" src="http://4.bp.blogspot.com/-aJRmzsk6Wcw/TuEsmb4z0cI/AAAAAAAAAB4/CmOPzqDbR50/s320/Oracle11ClientInstallOptions.PNG" /></a></div> <b>Reboot the SQL Server box</b><p>Reboot the server so that SQL Server 2008R2 can pick up the installed Oracle provider. When the server comes back up, you should see the new oracle provider appear in the linked server providers section in SQL Server Management Studio.</p> <div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-FaY0TZhy_Xg/TuEtgDt6DbI/AAAAAAAAACQ/K2me3Na2Jcg/s1600/OracleServerLinkProvider.PNG" imageanchor="1" style="clear:left; margin-right:1em; margin-bottom:1em"><img border="0" height="271" width="224" src="http://2.bp.blogspot.com/-FaY0TZhy_Xg/TuEtgDt6DbI/AAAAAAAAACQ/K2me3Na2Jcg/s320/OracleServerLinkProvider.PNG" /></a></div> <b>Configure Oracle Link Provider Properties</b><p>Right click on the OraOLEDB.Oracle provider and select properties. Check the following options and save changes.</p><ul><li>Dynamic parameter</li><li>Allow inprocess</li></ul><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-BhTMiAlwodk/TuEuGlWsaPI/AAAAAAAAACc/Rk8ErtTIztI/s1600/OracleServerLinkProviderSettings.PNG" imageanchor="1" style="margin-left:1em; margin-right:1em"><img border="0" height="93" width="320" src="http://2.bp.blogspot.com/-BhTMiAlwodk/TuEuGlWsaPI/AAAAAAAAACc/Rk8ErtTIztI/s320/OracleServerLinkProviderSettings.PNG" /></a></div> <b>Configure TNS Names</b><p>At this point, you need to configure TNS entries for connecting to your Oracle instance. The easiest thing to do is take an existing tnsnames.ora file from a working server and copy it to the "network\admin" directory in your root oracle install path. ( in my case, my TNS names file is in the path "c:\app\product\11.2.0\client_1\network\admin\tnsnames.org")</p> <b>Create Oracle Linked Server</b><p>Go back into SQL Server Management Studio and browse to the Linked Servers folder. Right click that folder and select "New Linked Server...".</p><p>In the general tab...</p><ul><li>Type in the name of the linked server (whatever you want) into the "Linked server:" field</li><li>Select "Oracle Provider for OLE DB" as the Provider</li><li>Put in any value you want for the Product name - something like "Oracle" will do.</li><li>Set the Data source: to the TNS name of the connection you want to use from your TNS file.</li><li>Leave the provider string empty</li></ul><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-PgK3SvUrG3E/TuEyQ5fg5oI/AAAAAAAAACo/VerT6gZdkBY/s1600/NewLinkedServerGeneral.PNG" imageanchor="1" style="margin-left:1em; margin-right:1em"><img border="0" height="286" width="320" src="http://3.bp.blogspot.com/-PgK3SvUrG3E/TuEyQ5fg5oI/AAAAAAAAACo/VerT6gZdkBY/s320/NewLinkedServerGeneral.PNG" /></a></div> <p>In the security tab...</p><ul><li>Select the last radio button "Be made using this security context"</li><li>Enter the oracle account username/password in the fields under the checked radio button</li></ul> <div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-4rsK-fjIxpE/TuEyWmQjloI/AAAAAAAAAC0/JzIeaaGpMgs/s1600/NewLinkedServerSecurity.PNG" imageanchor="1" style="margin-left:1em; margin-right:1em"><img border="0" height="286" width="320" src="http://1.bp.blogspot.com/-4rsK-fjIxpE/TuEyWmQjloI/AAAAAAAAAC0/JzIeaaGpMgs/s320/NewLinkedServerSecurity.PNG" /></a></div> <p>...and click "OK" to finish up.</p>