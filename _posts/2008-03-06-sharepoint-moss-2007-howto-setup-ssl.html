---
layout: post
title: 'SharePoint MOSS 2007: Howto setup SSL for IIS 6 and configure Central Admin
  to use SSL'
date: '2008-03-06T16:52:00.000-08:00'
author: Bryan
tags:
- MOSS
- SharePoint
modified_time: '2008-11-12T18:32:10.019-08:00'
thumbnail: http://3.bp.blogspot.com/_It8-g3_9vec/R9CWGUBD_1I/AAAAAAAAAP4/o1HXB4MtrjU/s72-c/ssl_config_2.png
blogger_id: tag:blogger.com,1999:blog-19111454.post-1335009065361031379
blogger_orig_url: http://www.bryansgeekspeak.com/2008/03/sharepoint-moss-2007-howto-setup-ssl.html
---

<span style="font-weight:bold;">Refrences</span><br /><br />IIS 6 SSL certificate howto:<br /><a href="http://support.microsoft.com/kb/290625">http://support.microsoft.com/kb/290625</a><br />Command line for switching the Sharepoint Central Admin to use SSL:<br /><a href="http://technet2.microsoft.com/windowsserver/WSS/en/library/6b1c222e-d70c-4b79-8a89-c904c8bb67031033.mspx?mfr=true">http://technet2.microsoft.com/windowsserver/WSS/en/library/6b1c222e-d70c-4b79-8a89-c904c8bb67031033.mspx?mfr=true</a><br />note that SSL cant be setup in the Sharepoint/MOSS install wizard, you must use the command line tools.<br /><br /><span style="font-weight:bold;">Overview</span><br /><br />If you want to remotely configure Sharepoint services via the Central Administrator site, Microsoft recommends that you use SSL to secure the connection.  They just fail to tell you how to enable SSL for the central administrator site anywhere in the install wizard.  Also, if you want to use MOSS content publishing features (pushing content from one Site Collection/farm to another using the Central Administrator) you should use SSL for your Central Administrator because that service sends authentication from server to server via the http protocol with every publish attempt.<br /><br />This article just rehashes (and hopefully simplifies) what’s described in the resources listed above.  I don’t go into any detail about creating a Certificate Authority or issuing the SSL certificate, I assume you already have one setup or use a service like Verisign.<br /><br /><span style="font-weight:bold;">Step by Step: Adding SSL to the Sharepoint Central Administrator site</span><br /><br />1) Once Sharepoint or MOSS is installed on your target server, run the "Sharepoint Products and Technologies Configuration Wizard" to create the Central Administrator site as you normally would.<br /><br />2) From the IIS manager (Start-&gt;Program files-&gt;Administrative tools-&gt; IIS Manger) view the properties of the "SharePoint Central Administration v3" website<br /><br />3) Generate an SSL certificate request  (Directory Security-&gt;Secure Communications-&gt;Server Certificate) as shown below<br /><br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://3.bp.blogspot.com/_It8-g3_9vec/R9CWGUBD_1I/AAAAAAAAAP4/o1HXB4MtrjU/s1600-h/ssl_config_2.png"><img style="display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;" src="http://3.bp.blogspot.com/_It8-g3_9vec/R9CWGUBD_1I/AAAAAAAAAP4/o1HXB4MtrjU/s320/ssl_config_2.png" border="0" alt=""id="BLOGGER_PHOTO_ID_5174801007045246802" /></a><br /><br />4) Once the request is generated (as a .txt file) send that off to your certificate authority as described in the references section above.  You’ll receive an SSL cert in return (from whoever manages the CA).  Install the cert on the Central Administration IIS site as described above in the references section, but set the SSL port to something you will remember.  In my examples, I use port 4444 as my SSL port.<br /><br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://4.bp.blogspot.com/_It8-g3_9vec/R9CWGkBD_2I/AAAAAAAAAQA/0QLwjARM0Kk/s1600-h/ssl_config_3.png"><img style="display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;" src="http://4.bp.blogspot.com/_It8-g3_9vec/R9CWGkBD_2I/AAAAAAAAAQA/0QLwjARM0Kk/s320/ssl_config_3.png" border="0" alt=""id="BLOGGER_PHOTO_ID_5174801011340214114" /></a><br /><br />5) Now that we have SSL setup in IIS, we need to tell SharePoint that the central admin is going to be using the new port and the SSL protocol.  The only way to do this is from the command line on the webserver (and you must do this for every web server front end in your farm):<br /><br /><div class="code">c&gt;&quot;%COMMONPROGRAMFILES%\microsoft shared\web server extensions\12\bin\stsadm&quot; -o setadminport -p 4444 -ssl<br /></div><br />6)At this point, I always restart the Central Administration website in IIS out of habit, though I don’t think it’s necessary.  Once that’s done, you should be able to hit your central admin via SSL by going to http://&lt;your server name or ip&gt;:4444.  Also, the command line operation updates the shortcut located in (start-&gt;program files-&gt;Microsoft office server-&gt;SharePoint 3.0 Central Administration), so you can use that to get the full url too.<br /><br /><span style="font-weight:bold;">Final thoughts</span><br />If you want to use your own in-house certificate authority, you should install your CA root certificate on every server that will need to access the Central Administration Site .  For instance, if you have a staging server pushing content to a live server via the Central Administrator content publishing options in MOSS, you should install the CA root certificate on the staging server so that it can confirm the live server’s SSL cert is valid when it connects to deliver content via HTTPS.