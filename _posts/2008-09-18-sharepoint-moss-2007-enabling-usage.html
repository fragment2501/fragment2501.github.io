---
title: 'MOSS: Enabling Usage Statistics Reporting'
date: '2008-09-18T12:13:00.000-07:00'
author: Bryan
tags:
- MOSS
modified_time: '2008-09-18T13:39:46.574-07:00'
thumbnail: http://4.bp.blogspot.com/_It8-g3_9vec/SNKqVisFbkI/AAAAAAAAASo/_QlkbHanMOE/s72-c/usage_statistics_1.jpg
blogger_id: tag:blogger.com,1999:blog-19111454.post-4183131231807220607
blogger_orig_url: http://www.bryansgeekspeak.com/2008/09/sharepoint-moss-2007-enabling-usage.html
---

You might think it should be a straight forward thing to do, but it actually took a bit of fumbling around for me to get usage statistics reports working properly in MOSS.  Here's how to get it working on your farm:<br /><br />1) Enable usage statistics in the Central Administrator under <b>Operations->Usage Analysis Processing</b>.  Check both <b>Enable Logging</b> and <b>Enable usage analysis processing</b> and click OK.<br /><br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://4.bp.blogspot.com/_It8-g3_9vec/SNKqVisFbkI/AAAAAAAAASo/_QlkbHanMOE/s1600-h/usage_statistics_1.jpg"><img style="display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;" src="http://4.bp.blogspot.com/_It8-g3_9vec/SNKqVisFbkI/AAAAAAAAASo/_QlkbHanMOE/s320/usage_statistics_1.jpg" border="0" alt=""id="BLOGGER_PHOTO_ID_5247443802905734722" /></a><br /><br />2) Enable usage statistics from the Shared Services Provider for the sites you want to collect data on.  I have no idea why this is necessary, but apparently you can enable/disable statistics gathering at the SSP level, so some sites can use it and some cant.  From the Central Administrator, browse to <b>Shared Services Administrator</b> then manage the SSP that your site is under. From the SSP administration site, browse to <b>Usage Reporting</b> and check <b>Enable advanced usage analysis processing.</b>.  If you use the built in sharepoint search, the search option might be useful to you as well (we use a google mini, so its turned off in the screen shot below).<br /><br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://3.bp.blogspot.com/_It8-g3_9vec/SNKr5QYVqTI/AAAAAAAAASw/jZpmaSfEyUE/s1600-h/usage_statistics_2.jpg"><img style="display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;" src="http://3.bp.blogspot.com/_It8-g3_9vec/SNKr5QYVqTI/AAAAAAAAASw/jZpmaSfEyUE/s320/usage_statistics_2.jpg" border="0" alt=""id="BLOGGER_PHOTO_ID_5247445515977992498" /></a><br /><br />Now, at this point I thought I was done.  Some log directories and files were created in the path set in step #1, but no reports ever became available.  After a poking around google a bit, I found a few more requirements that microsoft does not make very clear in order to get usage statistics working, shown in the last two steps:<br /><br />3) Add the <b>Reporting</b> feature to your site collection.<br /><br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://4.bp.blogspot.com/_It8-g3_9vec/SNKzlfl2_FI/AAAAAAAAAS4/jpXHJ_xY9V8/s1600-h/usage_statistics_3.jpg"><img style="display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;" src="http://4.bp.blogspot.com/_It8-g3_9vec/SNKzlfl2_FI/AAAAAAAAAS4/jpXHJ_xY9V8/s320/usage_statistics_3.jpg" border="0" alt=""id="BLOGGER_PHOTO_ID_5247453972556872786" /></a><br /><br />4) Restart IIS.  In my test, I ended up rebooting the server, but I've seen reports in other blogs that restarting IIS is enough to get it working.<br /><br />With all that done, you'll need to wait until your first report is generated (scheduled in step #1) to see any data.  When that happens, you can browse to http://&lt;yourcollection&gt;<b>/_layouts/usageDetails.aspx</b> to see the report similar to this:<br /><br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://3.bp.blogspot.com/_It8-g3_9vec/SNK0kisYoiI/AAAAAAAAATA/5YPHHd9OLiE/s1600-h/usage_statistics_4.jpg"><img style="display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;" src="http://3.bp.blogspot.com/_It8-g3_9vec/SNK0kisYoiI/AAAAAAAAATA/5YPHHd9OLiE/s320/usage_statistics_4.jpg" border="0" alt=""id="BLOGGER_PHOTO_ID_5247455055721308706" /></a><br /><br />And just like the settings page, there is one for every site in your collection, and it only shows statistics for that site.  To view statistics across your entire collection, you'll need to use SharePoint Designer.  Open the site and from the toolbar browse to <b>Site->Reports->Usage</b> to see the list of available reports.<br /><br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://1.bp.blogspot.com/_It8-g3_9vec/SNK1_B1QEKI/AAAAAAAAATI/LZlYN1HRWws/s1600-h/usage_statistics_5.jpg"><img style="display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;" src="http://1.bp.blogspot.com/_It8-g3_9vec/SNK1_B1QEKI/AAAAAAAAATI/LZlYN1HRWws/s320/usage_statistics_5.jpg" border="0" alt=""id="BLOGGER_PHOTO_ID_5247456610268221602" /></a>