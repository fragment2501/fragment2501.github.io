---
title: 'SharePoint MOSS 2007: Can we create a union of a Document Library and A Pages
  Library?'
date: '2008-03-04T14:18:00.000-08:00'
author: Bryan
tags:
- MOSS
modified_time: '2008-11-12T18:32:10.524-08:00'
thumbnail: http://4.bp.blogspot.com/_It8-g3_9vec/R83NpUBD_xI/AAAAAAAAAPA/uJYEq8LXed8/s72-c/CrossListQuery_1.png
blogger_id: tag:blogger.com,1999:blog-19111454.post-5015423233288929713
blogger_orig_url: http://www.bryansgeekspeak.com/2008/03/sharepoint-moss-2007-can-we-create.html
---

<b>The short answer:</b> <br />No, not directly in the web interface via a Content Query web part. (The work around I used is at the bottom of this article, if you want to just skip to that)<br /><br /><b>The long drawn out answer/explanation/example ...</b><br />I have a Web Publishing site on my MOSS 2007 Server.  I have both Office word/excel/powerpoint documents and web pages to display in my site.  I add pages using the web interface, selecting the articles page template so that my users can manage the content.  Web pages go into the site <i>Page Library</i>.  That works great.  I upload documents into the site’s <i>Document Library</i>.  That works fine too.  Now, consider we need to be able to display documents directly on the site.  That works by manually adding hyperlinks to content just fine.  Now, here comes the problem...<br /><br />Both my office documents AND my pages, now stored in different Library types, need to be listed in the same results query within a Web Part. Basically, my users consider both types of files to be "Articles".  They should all be merged together into one list, sorted by date descending, for display in a "whats new" page.  So, if I have a word document called "Article1.docx" and a web page called "Article2.aspx" I need the list to show in a web part like this:<br /><br /><div class="code"><br />Article1 (Article1.docx)<br />Article2 (Article2.aspx)<br />...<br /></div><br />Lets take a look at how we might attempt to do this in MOSS out of the box:<br /><br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://4.bp.blogspot.com/_It8-g3_9vec/R83NpUBD_xI/AAAAAAAAAPA/uJYEq8LXed8/s1600-h/CrossListQuery_1.png"><img style="display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;" src="http://4.bp.blogspot.com/_It8-g3_9vec/R83NpUBD_xI/AAAAAAAAAPA/uJYEq8LXed8/s320/CrossListQuery_1.png" border="0" alt=""id="BLOGGER_PHOTO_ID_5174017656550063890" /></a><br /><br />Here you can see we have a <i>Document Library</i> and a <i>Page Library</i> in our Articles site.  Both libraries currently contain files: 2 office documents and  4 web pages.  The goal, again, is to merge and sort these results into one list of links for display on a whats new page.  Lets create the page and play with our out of the box webparts:<br /><br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://1.bp.blogspot.com/_It8-g3_9vec/R83OHkBD_yI/AAAAAAAAAPI/Ttjg2ORk5wM/s1600-h/CrossListQuery_2.png"><img style="display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;" src="http://1.bp.blogspot.com/_It8-g3_9vec/R83OHkBD_yI/AAAAAAAAAPI/Ttjg2ORk5wM/s320/CrossListQuery_2.png" border="0" alt=""id="BLOGGER_PHOTO_ID_5174018176241106722" /></a><br /><br />Above is a Welcome page for the Articles site.  I’ve added 2 Web Parts.  Both are "Content Query Tool Part" types.  The first Web Part gets all the results from the Pages library, the second gets the Documents Library results.  Why didn’t I just use one Web Part to display all the data?  Check out the interface in the screenshot for configuring the query section for the Content Query Web Part.  <b>The Content Query Web Part forces you to filter by a single List/Library Type</b> ... and as you can see, two types at that level are "Document Library" and "Pages Library".  The two types can not be combined at all via this web part.<br /><br /><b>So..what do we do now?</b><br /><br />First thought: stick to using 1 type of List/Library for all your content (if you can).<br /><br />If you need more than one list type for whatever reason, then you could try to dig into Sharepoint Designer and attempt to join the two List types via XML web service calls, then figure out how to display the returned XML data in a custom web part.<br /><br />Finally, there may be a way to do this with a custom List type defined at the site level.  I don’t know how custom lists work yet, so this is just a guess on my part.<br /><br /><b>Moving to a single List type solved my problem</b><br /><br />In my case, I was able to use a single list type ... though I don't know what problems might come up down the road from doing it this way.  I moved all of my office documents from the Document Library to the Page Library using the "Site Actions-&gt;Manage Content and Structure" tool.  Then I changed the the Content Query Web Part to pull All Content Types from the Pages Library:<br /><br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://1.bp.blogspot.com/_It8-g3_9vec/R83OOkBD_zI/AAAAAAAAAPQ/awd_KmV7plA/s1600-h/CrossListQuery_3.png"><img style="display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;" src="http://1.bp.blogspot.com/_It8-g3_9vec/R83OOkBD_zI/AAAAAAAAAPQ/awd_KmV7plA/s320/CrossListQuery_3.png" border="0" alt=""id="BLOGGER_PHOTO_ID_5174018296500191026" /></a>