---
title: MOSS 2007 - Workflow Approval Sets Modified By to "System Account" Part 2
date: '2009-03-06T08:34:00.000-08:00'
author: Bryan
tags:
- MOSS
- SharePoint
modified_time: '2009-03-06T08:58:39.779-08:00'
blogger_id: tag:blogger.com,1999:blog-19111454.post-2897952434501609276
blogger_orig_url: http://www.bryansgeekspeak.com/2009/03/moss-2007-show-sharepoint-version_06.html
---

In my previous post on workflow approval <a href="http://bryansgeekspeak.blogspot.com/2009/02/moss-2007-workflow-approval-sets.html">"MOSS 2007 - Workflow Approval Sets Modified By to "System Account""</a> I talked about the problem of how versions are created and updated by SharePoint as part of a custom workflow, causing the Modified By property of the page/item to be set to the system account rather than the account of the last person who actually worked on the page/item. That post shows an attempt at a solution that does not work, where I was still trying to understand how to use a SharePoint list event handler.<br /><br />I was able to get the event handler working, but with a drawback: When an item is approved, the event handler sets the Modified By property of the page/item, but then it also creates a new draft version of the item in the version history. This could be confusing for users, but in my situation it's an acceptable solution. Below you'll find the entire project, zipped up using <a href="http://www.7-zip.org/">7-zip format</a>.<br /><br /><iframe scrolling="no" marginheight="0" marginwidth="0" frameborder="0" style="width:240px;height:66px;margin:3px;padding:0;border:1px solid #dde5e9;background-color:#ffffff;" src="http://cid-d2c686e4e0564f73.skydrive.live.com/embedrowdetail.aspx/Public/UpdateTaskColumns%7C_06march2009.7z"></iframe><br /><br />To install the event handler, follow the directions listed in the previous post <a href="http://bryansgeekspeak.blogspot.com/2009/02/moss-2007-workflow-approval-sets.html">"MOSS 2007 - Workflow Approval Sets Modified By to "System Account""</a>, but use the Feature.xml, Elements.xml and UpdateTaskColumns.dll from building the project.