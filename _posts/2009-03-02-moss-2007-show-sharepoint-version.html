---
title: MOSS 2007 - Show SharePoint Version Number in MS Word Documents
date: '2009-03-02T11:13:00.001-08:00'
tags:
- MOSS
- SharePoint
modified_time: '2011-03-21T12:51:56.974-07:00'
thumbnail: http://3.bp.blogspot.com/_It8-g3_9vec/SjxOhrlmlfI/AAAAAAAAAsI/JctMnLzjAPE/s72-c/3DocumentLibraryAdvancedSettings.JPG
blogger_id: tag:blogger.com,1999:blog-19111454.post-5807917092527693183
blogger_orig_url: http://www.bryansgeekspeak.com/2009/03/moss-2007-show-sharepoint-version.html
---

<div class="sidenote">UPDATE: I've just verified this technique also works with SharePoint 2010.  Also keep in mind this technique only seems to work for documents in MS Word 2007 .docx format.  I assume it will also work in MS Word 2010, but I have not tested that yet.<br /><br />UPDATE 2: I should have posted this sooner, but I have run into problems on SharePoint 2010 with sites that are heavily customized (sites from MOSS 2007 that had been heavily customized before being upgraded to 2010, then copied to create new sites) getting versioning to work as described below. I havent been able to determine what the problem is or how to fix it yet.<br /></div><br />One of the requirements here at work is that we normally save the current "version number", which is user entered and maintained, into word documents that go out to clients.  At some point, someone ends up forgetting to update the version number and version history, but they always have to enter that information into SharePoint when they check the document in.  So, how can we automatically insert that information into a word document from SharePoint?<br /><br />Sadly, there is no easy "out of the box" way to do this.  The version number you see in the properties of a word document is MS Word's own internal version number that does not relate to the SharePoint version number in any way.<br /><br />One solution I've found to work well is setting up an information policy on the document library in order to enable labels.  You can then define a label that displays the current version number, which you can then insert into a MS Word 2007 document as an image (it seems to look best in the document footer, imo).  Here's how:<br /><br /><ol><li>Create a new document library or modify an existing one</li><li>In the library settings, under "Advanced Settings" set "Allow management of content types?" to "yes".<br /><br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://3.bp.blogspot.com/_It8-g3_9vec/SjxOhrlmlfI/AAAAAAAAAsI/JctMnLzjAPE/s1600-h/3DocumentLibraryAdvancedSettings.JPG"><img style="cursor:pointer; cursor:hand;width: 320px; height: 209px;" src="http://3.bp.blogspot.com/_It8-g3_9vec/SjxOhrlmlfI/AAAAAAAAAsI/JctMnLzjAPE/s320/3DocumentLibraryAdvancedSettings.JPG" border="0" alt=""id="BLOGGER_PHOTO_ID_5349236797952398834" /></a><br /><br /></li><li>Enable versioning (it does not matter if you do minor versions or not).<br /><br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://2.bp.blogspot.com/_It8-g3_9vec/SjxOhb8me5I/AAAAAAAAAsA/2UkIf-T0VGo/s1600-h/2DocumentLibraryVersionControl.JPG"><img style="cursor:pointer; cursor:hand;width: 320px; height: 220px;" src="http://2.bp.blogspot.com/_It8-g3_9vec/SjxOhb8me5I/AAAAAAAAAsA/2UkIf-T0VGo/s320/2DocumentLibraryVersionControl.JPG" border="0" alt=""id="BLOGGER_PHOTO_ID_5349236793753893778" /></a><br /><br /></li><li>Create a new information policy on the library, and select the content type you want the label to be available to (I use the default "document" type).<br /><br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://2.bp.blogspot.com/_It8-g3_9vec/SjxQJXsGPaI/AAAAAAAAAso/flshk_trXuM/s1600-h/4DocumentLibraryInfoPolicy2.JPG"><img style="cursor:pointer; cursor:hand;width: 320px; height: 71px;" src="http://2.bp.blogspot.com/_It8-g3_9vec/SjxQJXsGPaI/AAAAAAAAAso/flshk_trXuM/s320/4DocumentLibraryInfoPolicy2.JPG" border="0" alt=""id="BLOGGER_PHOTO_ID_5349238579317325218" /></a><br /></li><li>Define a new policy, check "Enable Labels". Do not check the other two options Below it.  In the "Label format" field, enter something like "SharePoint Version Number: {Version}".  {Version} is the field that will display the version number.  Modify the "Appearance" settings to suit your needs, then click "OK".<br /><br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://2.bp.blogspot.com/_It8-g3_9vec/SjxOh9sgZoI/AAAAAAAAAsQ/lcdjpPeG21U/s1600-h/5DocumentLibraryInfoPolicy2.JPG"><img style="cursor:pointer; cursor:hand;width: 320px; height: 288px;" src="http://2.bp.blogspot.com/_It8-g3_9vec/SjxOh9sgZoI/AAAAAAAAAsQ/lcdjpPeG21U/s320/5DocumentLibraryInfoPolicy2.JPG" border="0" alt=""id="BLOGGER_PHOTO_ID_5349236802813191810" /></a><br /><br /></li></ol><br />I typically set the size of the label to something thin, like .5 inches, so I can tuck it into the footer of the word document and still keep the footer small.  Now, the label will not automatically show up in your documents, you still need to insert the label yourself.  And so far, it seems this feature only works with Word 2007 documents, my 2003 word documents just display a field name rather than a number.  Anywho, to setup your word document:<br /><br /><ol><li>Create a new document in the library.</li><li>Save the new word document as a word 2007 file (.docx format) in the library.<br /><br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://3.bp.blogspot.com/_It8-g3_9vec/SjxPRbzH0VI/AAAAAAAAAsg/WybizoS79cE/s1600-h/1DocumentLibrarySettings.JPG"><img style="cursor:pointer; cursor:hand;width: 320px; height: 206px;" src="http://3.bp.blogspot.com/_It8-g3_9vec/SjxPRbzH0VI/AAAAAAAAAsg/WybizoS79cE/s320/1DocumentLibrarySettings.JPG" border="0" alt=""id="BLOGGER_PHOTO_ID_5349237618347856210" /></a><br /></li><li>Check out and edit the word 2007 document, click the "insert" tab in the ribbon, then click "Quick Parts" in the "Text" button group.  Under "Document Properties" click on "Label" to insert your SharePoint label as an image.<br /><br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://3.bp.blogspot.com/_It8-g3_9vec/SjxOh2atvMI/AAAAAAAAAsY/LlInzGMKvts/s1600-h/6LabelsInWord2007.JPG"><img style="cursor:pointer; cursor:hand;width: 320px; height: 175px;" src="http://3.bp.blogspot.com/_It8-g3_9vec/SjxOh2atvMI/AAAAAAAAAsY/LlInzGMKvts/s320/6LabelsInWord2007.JPG" border="0" alt=""id="BLOGGER_PHOTO_ID_5349236800859520194" /></a><br /></li><li>save your document, checkin and close word 2007.  Then re-open the document and you should see the label change to the actual SharePoint version number of the document.</li></ol><br />..and one last thought - Since the format of the text for the version number label might change due to personal preference (some might want to use "SharePoint Version Number: x", while others use "Version: x") it may be a good idea to simply display the version number only, as a small image by itself with no additional text. This way the document author has more control over how the version number is displayed and described in their document.