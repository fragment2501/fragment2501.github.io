---
layout: post
title: Stripping extended ascii characters from MS word copy/paste
date: '2007-02-19T12:29:00.000-08:00'
author: Bryan
tags:
- ColdFusion
modified_time: '2008-02-13T13:42:44.330-08:00'
blogger_id: tag:blogger.com,1999:blog-19111454.post-55702702574785072
blogger_orig_url: http://www.bryansgeekspeak.com/2007/02/stripping-extended-ascii-characters.html
---

<span class="452291620-19022007">(( this isnt my work, I just posted it here so I wouldnt loose it.  I'll post the author's name and website when I find it ))<br /><br /></span><br /><br /><br /><br />Expecting to see all sorts of  copy-n-pasted text from ms word<br />containing things like the ellipse  (&amp;#0133;), left single-quote (&amp;#0145;),<br />right single-quote  (&amp;#0146;), and smart quotes (left double-quote - &amp;#0147;<br />and right  double-quote - &amp;#0148;) along with all sorts of naughty  high-ascii<br />characters?  then do the right thing and convert them to their  numeric<br />character entity.  using cold fusion this is as simple as  constructing two<br />lists (one containing all the actual characters which you'll  use to search<br />for and the other containing the appropriate numeric character  entities<br />which you'll replace them with).<br /><br />&lt;textarea&gt;<br />&lt;!--- initialize the  variable - bad_chars ---&gt;<br />&lt;cfparam name=&quot;bad_chars&quot; default=&quot;&quot;&gt;<br />&lt;!--- initialize the variable - good_chars  ---&gt;<br />&lt;cfparam name=&quot;good_chars&quot; default=&quot;&quot;&gt;<br />&lt;!--- loop through  the range of high-ascii ---&gt;<br />&lt;cfloop index=&quot;i&quot; from=&quot;127&quot; to=&quot;255&quot;&gt;<br />  &lt;!--- append each high-ascii character to a  list<br />         contained in the variable bad_chars ---&gt;<br />  &lt;cfset bad_chars =&quot; ListAppend(bad_chars,&quot;&gt;<br />  &lt;!--- append each numeric  character entity<br />         representation of the high-ascii character  to<br />         a list contained in the variable good_chars  ---&gt;<br />   &lt;cfset good_chars =&quot; ListAppend(good_chars,&quot; class=&quot;452291620-19022007&quot;&gt; &lt;/span&gt;&amp;amp; NumberFormat(i, '0000') &amp;  &quot;;&quot;)&gt;<br />&lt;/cfloop&gt;<br /><br />&lt;cfquery name=&quot;InsertReport&quot; datasource=&quot;mysource&quot;&gt;<br />  INSERT INTO reportstable (<br />    Content<br />   )<br />  VALUES (<br />    '#Trim(ReplaceList(Content, bad_chars,  good_chars))#'<br />  )<br />&lt;/cfquery&gt;<br />&lt;cfparam name=&quot;bad_chars&quot; default=&quot;&quot;&gt;&lt;cfparam name=&quot;good_chars&quot; default=&quot;&quot;&gt;&lt;cfloop index=&quot;i&quot; from=&quot;127&quot; to=&quot;255&quot;&gt;&lt;cfset bad_chars=&quot; ListAppend(bad_chars,&quot;&gt;&lt;cfquery name=&quot;InsertReport&quot; datasource=&quot;mysource&quot;&gt;&lt;/cfquery&gt;&lt;/cfset&gt;&lt;/cfloop&gt;&lt;/cfparam&gt;&lt;/cfparam&gt;<br />&lt;/textarea&gt;