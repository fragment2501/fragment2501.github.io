---
layout: post
title: 'SharePoint MOSS 2007 - Web Publishing Portal: Job Listing Site'
date: '2008-02-13T11:21:00.000-08:00'
author: Bryan
tags:
- MOSS
modified_time: '2008-09-18T14:08:57.858-07:00'
blogger_id: tag:blogger.com,1999:blog-19111454.post-5994984367779298077
blogger_orig_url: http://www.bryansgeekspeak.com/2008/02/sharepoint-moss-2007-web-publishing.html
---

<span style="font-style:italic;">A simple example of displaying dynamic content using a Content Query Web Part</span><br /><br />One part of the demo site I'm working on is a typical "Job Openings" page.  In the Corporate section of the website, the owners want to be able to direct users to a page that lists links to the 10 most recently posted job openings.  This page needs to be dynamic so that when a new job opening is published (as an article page to the job Site) a link is automatically displayed on the Job Openings main page (the jobs site welcome page).<br /><br />To do this, I'm going to create a new Site called "Jobs" where all the job opening content will be stored.  We will use the default page on the Jobs Site (called a Welcome page in MOSS speak) to list the 10 most recent job postings.<br /><br /><ol><br /><li>Goto the "Corporate" Site</li><br /><li>select "Create Site" from the Site Actions menu.</li><br /><ol><br /><li>set an appropriate title like "Careers"</li><br /><li>Web Site Address to be "jobs" (the full path should be "/corporate/jobs")</li><br /><li>Select the template "Publishing->Publishing Site"</li><br /><li>Leave the rest of the defaults so permissions and navigation inherit from the parent site. Click "OK" to create the Site.</li><br /></ol><br /></ol><br /><br />Now that we've got our new Site in place to hold all the content, lets edit the jobs Site Welcome page to dynamically list any other Article Page content in this site. We'll assume that any Article Page published to this site will be a new job listing.  <br /><br /><ol><br /><li>Edit the "job" Site Welcome page</li><br /><li>Add a new "Content Query Web Part" to Left Column Web Part placement area. (I am assuming the default template being used is "Welcome page with summary links")</li><br /><li>Modify the settings Content Query Web Part you just added to do the following:</li><br /><ol><br /><li>Select "Query->Show items from the following site and all SubSites" and set the value to "/corporate/jobs"</li><br /><li>Change "Content Type->Show items of this type group" to "Page Layout Content Types"</li><br /><li>Change "Content Type->Show items of this content type" to "Article Page"</li><br /><li>Change "Presentation->Limit the number of items to display" to "10" and make sure the box next to that option is checked as well.</li><br /><li>Change the presentation, appearance and layout as needed to match the site look and feel</li><br /><li>Submit/publish changes to this page.</li><br /></ol><br /></ol><br /><br />With that done, the Web Part will automatically display a list of pages created in this Site, sorted by create date in descending order (all default settings that can be changed by modifying the Web Part).  Setting the content type filter in step 3.2 & 3.3 ensures that the default page for the Site will not be included in the list (the default site page is a welcome page, not an article page).