---
title: 'MOSS: Custom CQWP - Exploring the MulitChoice Column'
date: '2008-09-22T14:28:00.000-07:00'
author: Bryan
tags:
- MOSS
modified_time: '2008-09-23T08:25:15.831-07:00'
thumbnail: http://4.bp.blogspot.com/_It8-g3_9vec/SNgV_8EeuGI/AAAAAAAAAec/pZ6B-hZzp2s/s72-c/2_custom_column.jpg
blogger_id: tag:blogger.com,1999:blog-19111454.post-1791100996145436747
blogger_orig_url: http://www.bryansgeekspeak.com/2008/09/moss-custom-cqwp-exploring-mulitchoice.html
---

<div class="sidenote">We'll be working off of the example site, list, columns and CQWP used in the post <a href="http://bryansgeekspeak.blogspot.com/2008/09/sharepoint-moss-2007-walkthough.html">Walkthough Customizing a CQWP Instance</a>.</div><br /><br />In our last exercise we created a new team site, created a custom list and added a few custom columns to the list.  We added a text field called BDLLongDescription, and displayed its value as part of the results of a custom CQWP.  Now we'll look at the other column we created, which happens to be a special beast in MOSS: the MultiChoice column.<br /><br />Lets start by saying, avoid using a MultiChoice column type for display.  Think of this column type as something more used more for filtering and sorting, it works great for that. For display, the out of the box format for the MultiChoice column looks horrible...but its still readable, and useful for debugging.  Lets check it out.<br /><br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://4.bp.blogspot.com/_It8-g3_9vec/SNgV_8EeuGI/AAAAAAAAAec/pZ6B-hZzp2s/s1600-h/2_custom_column.jpg"><img style="display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;" src="http://4.bp.blogspot.com/_It8-g3_9vec/SNgV_8EeuGI/AAAAAAAAAec/pZ6B-hZzp2s/s320/2_custom_column.jpg" border="0" alt=""id="BLOGGER_PHOTO_ID_5248969553901172834" /></a><br /><br />your custom column should look like the above.  Check it in the list settings to verify.<br /><br />Next, export the CQWP as we did in the last example.  Modify the CommonViewFields to look like the screen below.<br /><br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://4.bp.blogspot.com/_It8-g3_9vec/SNgWANqVWxI/AAAAAAAAAek/aadC_QK-px0/s1600-h/3_customize_webpart.jpg"><img style="display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;" src="http://4.bp.blogspot.com/_It8-g3_9vec/SNgWANqVWxI/AAAAAAAAAek/aadC_QK-px0/s320/3_customize_webpart.jpg" border="0" alt=""id="BLOGGER_PHOTO_ID_5248969558623345426" /></a><br /><br />Import that guy, then edit the ItemStyle.xsl again, as we did in the last exercise.  Make a copy of BryansStyle and name it <b>BryansCategoryStyle</b> then add the line that references BDLLabel shown below. <br /><br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://1.bp.blogspot.com/_It8-g3_9vec/SNgfd68vEII/AAAAAAAAAe8/xNdNlwU5Qpk/s1600-h/3b_customize_webpart.jpg"><img style="display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;" src="http://1.bp.blogspot.com/_It8-g3_9vec/SNgfd68vEII/AAAAAAAAAe8/xNdNlwU5Qpk/s320/3b_customize_webpart.jpg" border="0" alt=""id="BLOGGER_PHOTO_ID_5248979964600979586" /></a><br /><br />Modify the web part, and under properties, select the new style <b>BryansCategoryStyle</b> and click apply.<br /><br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://4.bp.blogspot.com/_It8-g3_9vec/SNgWAWbs5_I/AAAAAAAAAes/vYIiJttH70U/s1600-h/4_category_item_style.jpg"><img style="display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;" src="http://4.bp.blogspot.com/_It8-g3_9vec/SNgWAWbs5_I/AAAAAAAAAes/vYIiJttH70U/s320/4_category_item_style.jpg" border="0" alt=""id="BLOGGER_PHOTO_ID_5248969560977893362" /></a><br /><br />Crazy!  Out of the box, you get access to that field but it doesnt display as you would expect.  The values are delimited by pound signs and simicolons ... argh! And though I'm sure there is an XML function we could write to rid us of that goo, its easier to simply avoid using this column type for anything other than just filtering and sorting.  You can, however, use the single select column for display, it works just fine out of the box.  In the .webpart file, that column type is considered a <b>Choice</b> type, rather than the <b>MultiChoice</b> type we used here.<br /><br />Now that we know to avoid using the MultiChoice column for display, lets try to filter using that column.  Modify the web part on our default page, then under the query section scroll down to <b>Additional Filters</b> and look for our new column...<br /><br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://1.bp.blogspot.com/_It8-g3_9vec/SNkKSZBkbzI/AAAAAAAAAfU/TqY8O0j34HM/s1600-h/5_where_is_my_custom_column.jpg"><img style="display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;" src="http://1.bp.blogspot.com/_It8-g3_9vec/SNkKSZBkbzI/AAAAAAAAAfU/TqY8O0j34HM/s320/5_where_is_my_custom_column.jpg" border="0" alt=""id="BLOGGER_PHOTO_ID_5249238151748415282" /></a><br /><br />...where the heck is it?! Well, look in the above section in the filter called <b>Content type</b>.  Change those values around and then look at what becomes available in the <b>Addition Filters</b> section.  Thats right, the list of metadata used for filtering is drawn from <b>Content Types</b>.  When I had you setup your custom columns, we didnt create a new content type for them.  We skipped around that part to add our columns directly to a list, which as you can see ends up limiting the usefulness of columns when they are not assigned to a content type.<br /><br />The next article will talk about content types in more detail. We'll setup a content type for our data, assign it to a custom list, then do some proper filtering using the CQWP.
